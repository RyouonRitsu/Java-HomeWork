<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Java8-17语法新特性总结 # 班级：202115
学号：19377054
姓名：周洪熙
Java 8 # Interface # interface 的设计初衷是面向抽象，提高扩展性。这也留有一点遗憾，interface 修改的时候，实现它的类也必须跟着改。
为了解决接口的修改与现有的实现不兼容的问题。新 interface 的方法可以用 default 或 static 修饰，这样就可以有方法体，实现类也不必重写此方法。
一个 interface 中可以有多个方法被它们修饰，这 2 个修饰符的区别主要也是普通方法和静态方法的区别。
default 修饰的方法，是普通实例方法，可以用this调用，可以被子类继承、重写。
static 修饰的方法，使用上和一般类静态方法一样。但它不能被子类继承，只能用Interface调用。 我们来看一个实际的例子。
public interface InterfaceNew { static void sm() { System.out.println(&#34;interface提供的方式实现&#34;); } static void sm2() { System.out.println(&#34;interface提供的方式实现&#34;); } default void def() { System.out.println(&#34;interface default方法&#34;); } default void def2() { System.out.println(&#34;interface default2方法&#34;); } //须要实现类重写 void f(); } public interface InterfaceNew1 { default void def() { System."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Java8-17语法新特性总结 # 班级：202115
学号：19377054
姓名：周洪熙
Java 8 # Interface # interface 的设计初衷是面向抽象，提高扩展性。这也留有一点遗憾，interface 修改的时候，实现它的类也必须跟着改。
为了解决接口的修改与现有的实现不兼容的问题。新 interface 的方法可以用 default 或 static 修饰，这样就可以有方法体，实现类也不必重写此方法。
一个 interface 中可以有多个方法被它们修饰，这 2 个修饰符的区别主要也是普通方法和静态方法的区别。
default 修饰的方法，是普通实例方法，可以用this调用，可以被子类继承、重写。
static 修饰的方法，使用上和一般类静态方法一样。但它不能被子类继承，只能用Interface调用。 我们来看一个实际的例子。
public interface InterfaceNew { static void sm() { System.out.println(&#34;interface提供的方式实现&#34;); } static void sm2() { System.out.println(&#34;interface提供的方式实现&#34;); } default void def() { System.out.println(&#34;interface default方法&#34;); } default void def2() { System.out.println(&#34;interface default2方法&#34;); } //须要实现类重写 void f(); } public interface InterfaceNew1 { default void def() { System."><meta property="og:type" content="article"><meta property="og:url" content="https://ryouonritsu.github.io/Java-HomeWork/docs/Resource/Java8-17%E8%AF%AD%E6%B3%95%E6%96%B0%E7%89%B9%E6%80%A7%E6%80%BB%E7%BB%93/"><meta property="article:section" content="docs"><title>Java8 17语法新特性总结 | 面向对象的程序设计</title><link rel=manifest href=/Java-HomeWork/manifest.json><link rel=icon href=/Java-HomeWork/favicon.png type=image/x-icon><link rel=stylesheet href=/Java-HomeWork/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous><script defer src=/Java-HomeWork/flexsearch.min.js></script>
<script defer src=/Java-HomeWork/en.search.min.b4d97a5b720e949fd7f91ce755dba88353aba394a60b53c922b5a423c2c69b2e.js integrity="sha256-tNl6W3IOlJ/X+RznVduog1Oro5SmC1PJIrWkI8LGmy4=" crossorigin=anonymous></script>
<script defer src=/Java-HomeWork/sw.min.f9d6a999699a3b48a5eb200be51ffe46d9f4e077c31bf4122a23051ca7b6bc92.js integrity="sha256-+dapmWmaO0il6yAL5R/+Rtn04HfDG/QSKiMFHKe2vJI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/Java-HomeWork/><span>面向对象的程序设计</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/Java-HomeWork/docs/OOP-LAB/>Oop Lab</a><ul><li><a href=/Java-HomeWork/docs/OOP-LAB/TEMPLATE/>Template</a></li></ul></li><li><a href=/Java-HomeWork/docs/MySCS/>My Scs</a><ul></ul></li><li><a href=/Java-HomeWork/docs/Resource/>Resource</a><ul><li><a href=/Java-HomeWork/docs/Resource/Java8-17%E8%AF%AD%E6%B3%95%E6%96%B0%E7%89%B9%E6%80%A7%E6%80%BB%E7%BB%93/ class=active>Java8 17语法新特性总结</a></li></ul></li></ul><ul><li><a href=https://github.com/RyouonRitsu/Java-HomeWork target=_blank rel=noopener>Github</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/Java-HomeWork/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Java8 17语法新特性总结</strong>
<label for=toc-control><img src=/Java-HomeWork/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#java8-17语法新特性总结>Java8-17语法新特性总结</a><ul><li><a href=#java-8>Java 8</a><ul><li><a href=#interface>Interface</a></li><li><a href=#lambda-表达式>Lambda 表达式</a></li><li><a href=#方法的引用>方法的引用</a></li><li><a href=#optional>Optional</a><ul><li><a href=#如何创建一个-optional>如何创建一个 Optional</a></li><li><a href=#map相关方法>map()相关方法</a></li><li><a href=#判断-value-是否为-null>判断 value 是否为 null</a></li><li><a href=#获取-value>获取 value</a></li><li><a href=#过滤值>过滤值</a></li></ul></li><li><a href=#date-time-api>Date-Time API</a><ul><li><a href=#javatime-主要类>java.time 主要类</a></li><li><a href=#格式化>格式化</a></li><li><a href=#字符串转日期格式>字符串转日期格式</a></li><li><a href=#日期计算>日期计算</a></li><li><a href=#获取指定日期>获取指定日期</a></li><li><a href=#时区>时区</a></li></ul></li></ul></li><li><a href=#java-9>Java 9</a><ul><li><a href=#jshell>JShell</a></li><li><a href=#模块化系统>模块化系统</a></li><li><a href=#快速创建不可变集合>快速创建<em>不可变集合</em></a></li><li><a href=#接口私有方法>接口私有方法</a></li><li><a href=#try-with-resources-增强>try-with-resources 增强</a></li><li><a href=#stream--optional-增强>Stream & Optional 增强</a></li><li><a href=#进程-api>进程 API</a></li></ul></li><li><a href=#java-10>Java 10</a><ul><li><a href=#局部变量类型推断var>局部变量类型推断(var)</a></li><li><a href=#集合增强>集合增强</a></li><li><a href=#optional-增强>Optional 增强</a></li></ul></li><li><a href=#java-11>Java 11</a><ul><li><a href=#http-client-标准化>HTTP Client 标准化</a></li><li><a href=#string-增强>String 增强</a></li><li><a href=#optional-增强-1>Optional 增强</a></li><li><a href=#lambda-参数的局部变量语法>Lambda 参数的局部变量语法</a></li></ul></li><li><a href=#java-12>Java 12</a><ul><li><a href=#string-增强-1>String 增强</a></li><li><a href=#files-增强文件比较>Files 增强（文件比较）</a></li><li><a href=#数字格式化工具类>数字格式化工具类</a></li></ul></li><li><a href=#java-13>Java 13</a><ul><li><a href=#socketapi-重构>SocketAPI 重构</a></li><li><a href=#filesystems>FileSystems</a></li></ul></li><li><a href=#java-14>Java 14</a><ul><li><a href=#空指针异常精准提示>空指针异常精准提示</a></li><li><a href=#switch-的增强>switch 的增强</a></li></ul></li><li><a href=#java-15>Java 15</a><ul><li><a href=#charsequence>CharSequence</a></li><li><a href=#treemap>TreeMap</a></li><li><a href=#eddsa数字签名算法>EdDSA(数字签名算法)</a></li><li><a href=#文本块>文本块</a></li></ul></li><li><a href=#java-16>Java 16</a><ul><li><a href=#记录类型>记录类型</a></li><li><a href=#instanceof-模式匹配>instanceof 模式匹配</a></li></ul></li><li><a href=#java-17>Java 17</a><ul><li><a href=#密封类>密封类</a></li><li><a href=#streamtolist>Stream.toList()</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=java8-17语法新特性总结>Java8-17语法新特性总结
<a class=anchor href=#java8-17%e8%af%ad%e6%b3%95%e6%96%b0%e7%89%b9%e6%80%a7%e6%80%bb%e7%bb%93>#</a></h1><blockquote><p>班级：202115</p><p>学号：19377054</p><p>姓名：周洪熙</p></blockquote><h2 id=java-8>Java 8
<a class=anchor href=#java-8>#</a></h2><h3 id=interface>Interface
<a class=anchor href=#interface>#</a></h3><p>interface 的设计初衷是面向抽象，提高扩展性。这也留有一点遗憾，interface 修改的时候，实现它的类也必须跟着改。</p><p>为了解决接口的修改与现有的实现不兼容的问题。新 interface 的方法可以用 <code>default</code> 或 <code>static</code> 修饰，这样就可以有方法体，实现类也不必重写此方法。</p><p>一个 interface 中可以有多个方法被它们修饰，这 2 个修饰符的区别主要也是普通方法和静态方法的区别。</p><p><code>default</code> 修饰的方法，是普通实例方法，可以用this调用，可以被子类继承、重写。</p><p><code>static</code> 修饰的方法，使用上和一般类静态方法一样。但它不能被子类继承，只能用Interface调用。
我们来看一个实际的例子。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>InterfaceNew</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sm</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;interface提供的方式实现&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sm2</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;interface提供的方式实现&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>def</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;interface default方法&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>def2</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;interface default2方法&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//须要实现类重写
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>f</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>InterfaceNew1</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>def</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;InterfaceNew1 default方法&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>如果有一个类既实现了 <code>InterfaceNew</code> 接口又实现了 <code>InterfaceNew1</code> 接口，它们都有 <code>def()</code> ，并且 <code>InterfaceNew</code> 接口和 <code>InterfaceNew1</code> 接口没有继承关系的话，这时就必须重写 <code>def()</code> 。不然的话，编译的时候就会报错。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>InterfaceNewImpl</span> <span style=color:#66d9ef>implements</span> InterfaceNew <span style=color:#f92672>,</span> InterfaceNew1<span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        InterfaceNewImpl interfaceNew <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> InterfaceNewImpl<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        interfaceNew<span style=color:#f92672>.</span><span style=color:#a6e22e>def</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>def</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        InterfaceNew1<span style=color:#f92672>.</span><span style=color:#a6e22e>super</span><span style=color:#f92672>.</span><span style=color:#a6e22e>def</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>f</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=lambda-表达式>Lambda 表达式
<a class=anchor href=#lambda-%e8%a1%a8%e8%be%be%e5%bc%8f>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>(</span>parameters<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> expression <span style=color:#a6e22e>或</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>parameters<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;{</span> statements<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Example: 替代匿名内部类</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> strings <span style=color:#f92672>=</span> Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> 2<span style=color:#f92672>,</span> 3<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//以前
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Collections<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>strings<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Comparator<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>compare</span><span style=color:#f92672>(</span>Integer o1<span style=color:#f92672>,</span> Integer o2<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> o1 <span style=color:#f92672>-</span> o2<span style=color:#f92672>;}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Lambda
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Collections<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>strings<span style=color:#f92672>,</span> <span style=color:#f92672>(</span>Integer o1<span style=color:#f92672>,</span> Integer o2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> o1 <span style=color:#f92672>-</span> o2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//分解开
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Comparator<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> comperator <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Integer o1<span style=color:#f92672>,</span> Integer o2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> o1 <span style=color:#f92672>-</span> o2<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>Collections<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>strings<span style=color:#f92672>,</span> comperator<span style=color:#f92672>);</span>
</span></span></code></pre></div><p>Example: 集合迭代</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>lamndaFor</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> strings <span style=color:#f92672>=</span> Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>asList</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;2&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;3&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//传统foreach
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>String s <span style=color:#f92672>:</span> strings<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//Lambda foreach
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        strings<span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>((</span>s<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>s<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//or
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        strings<span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>::</span>println<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//map
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        Map<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> map <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        map<span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>((</span>k<span style=color:#f92672>,</span>v<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>v<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Example: 访问变量</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>Collections<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>strings<span style=color:#f92672>,</span> <span style=color:#f92672>(</span>Integer o1<span style=color:#f92672>,</span> Integer o2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> o1 <span style=color:#f92672>-</span> i<span style=color:#f92672>);</span>
</span></span></code></pre></div><p>lambda 表达式可以引用外部变量，但是该变量默认拥有 final 属性，不能被修改，如果修改，编译时就报错。</p><h3 id=方法的引用>方法的引用
<a class=anchor href=#%e6%96%b9%e6%b3%95%e7%9a%84%e5%bc%95%e7%94%a8>#</a></h3><p>Java 8 允许使用 <code>::</code> 关键字来传递方法或者构造函数引用，无论如何，表达式返回的类型必须是 functional-interface。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LambdaClassSuper</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    LambdaInterface <span style=color:#a6e22e>sf</span><span style=color:#f92672>(){</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LambdaClass</span> <span style=color:#66d9ef>extends</span> LambdaClassSuper <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> LambdaInterface <span style=color:#a6e22e>staticF</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> LambdaInterface <span style=color:#a6e22e>f</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>show</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//1.调用静态函数，返回类型必须是functional-interface
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        LambdaInterface t <span style=color:#f92672>=</span> LambdaClass<span style=color:#f92672>::</span>staticF<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//2.实例方法调用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        LambdaClass lambdaClass <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> LambdaClass<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        LambdaInterface lambdaInterface <span style=color:#f92672>=</span> lambdaClass<span style=color:#f92672>::</span>f<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//3.超类上的方法调用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        LambdaInterface superf <span style=color:#f92672>=</span> <span style=color:#66d9ef>super</span><span style=color:#f92672>::</span>sf<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//4. 构造方法调用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        LambdaInterface tt <span style=color:#f92672>=</span> LambdaClassSuper<span style=color:#f92672>::</span><span style=color:#66d9ef>new</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=optional>Optional
<a class=anchor href=#optional>#</a></h3><blockquote><p>防止 NPE，是程序员的基本修养，注意 NPE 产生的场景：<br>1） 返回类型为基本数据类型，return 包装数据类型的对象时，自动拆箱有可能产生 NPE。<br>反例：public int f() { return Integer 对象 }， 如果为 null，自动解箱抛 NPE。<br>2） 数据库的查询结果可能为 null。<br>3） 集合里的元素即使 isNotEmpty，取出的数据元素也可能为 null。<br>4） 远程调用返回对象时，一律要求进行空指针判断，防止 NPE。<br>5） 对于 Session 中获取的数据，建议进行 NPE 检查，避免空指针。<br>6） 级联调用 obj.getA().getB().getC()；一连串调用，易产生 NPE。<br>正例：使用 JDK8 的 Optional 类来防止 NPE 问题。</p></blockquote><h4 id=如何创建一个-optional>如何创建一个 Optional
<a class=anchor href=#%e5%a6%82%e4%bd%95%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa-optional>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* Common instance for {@code empty()}. 全局EMPTY对象
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> Optional<span style=color:#f92672>&lt;?&gt;</span> EMPTY <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Optional<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* Optional维护的值
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> T value<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 如果value是null就返回EMPTY，否则就返回of(T)
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> Optional<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>ofNullable</span><span style=color:#f92672>(</span>T value<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> value <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>?</span> empty<span style=color:#f92672>()</span> <span style=color:#f92672>:</span> of<span style=color:#f92672>(</span>value<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 返回 EMPTY 对象
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> Optional<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>empty</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>   Optional<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> t <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Optional<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;)</span> EMPTY<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> t<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 返回Optional对象
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> Optional<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>T value<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> Optional<span style=color:#f92672>&lt;&gt;(</span>value<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 私有构造方法，给value赋值
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#a6e22e>Optional</span><span style=color:#f92672>(</span>T value<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> Objects<span style=color:#f92672>.</span><span style=color:#a6e22e>requireNonNull</span><span style=color:#f92672>(</span>value<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 所以如果of(T value) 的value是null，会抛出NullPointerException异常，这样貌似就没处理NPE问题
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> T <span style=color:#a6e22e>requireNonNull</span><span style=color:#f92672>(</span>T obj<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>obj <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> NullPointerException<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> obj<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p><code>ofNullable</code> 方法和 <code>of</code> 方法唯一区别就是当 value 为 null 时， <code>ofNullable</code> 返回的是EMPTY， <code>of</code> 会抛出 <code>NullPointerException</code> 异常。如果需要把 <code>NullPointerException</code> 暴露出来就用 <code>of</code> ，否则就用 <code>ofNullable</code> 。</p><h4 id=map相关方法>map()相关方法
<a class=anchor href=#map%e7%9b%b8%e5%85%b3%e6%96%b9%e6%b3%95>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 如果value为null，返回EMPTY，否则返回Optional封装的参数值
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>&lt;</span>U<span style=color:#f92672>&gt;</span> Optional<span style=color:#f92672>&lt;</span>U<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>map</span><span style=color:#f92672>(</span>Function<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>super</span> T<span style=color:#f92672>,</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>extends</span> U<span style=color:#f92672>&gt;</span> mapper<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Objects<span style=color:#f92672>.</span><span style=color:#a6e22e>requireNonNull</span><span style=color:#f92672>(</span>mapper<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>isPresent<span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> empty<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Optional<span style=color:#f92672>.</span><span style=color:#a6e22e>ofNullable</span><span style=color:#f92672>(</span>mapper<span style=color:#f92672>.</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>value<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 如果value为null，返回EMPTY，否则返回Optional封装的参数值，如果参数值返回null会抛 NullPointerException
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>&lt;</span>U<span style=color:#f92672>&gt;</span> Optional<span style=color:#f92672>&lt;</span>U<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>flatMap</span><span style=color:#f92672>(</span>Function<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>super</span> T<span style=color:#f92672>,</span> Optional<span style=color:#f92672>&lt;</span>U<span style=color:#f92672>&gt;&gt;</span> mapper<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Objects<span style=color:#f92672>.</span><span style=color:#a6e22e>requireNonNull</span><span style=color:#f92672>(</span>mapper<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>isPresent<span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> empty<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Objects<span style=color:#f92672>.</span><span style=color:#a6e22e>requireNonNull</span><span style=color:#f92672>(</span>mapper<span style=color:#f92672>.</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>value<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p><code>flatMap()</code> 参数返回值如果是 null 会抛 <code>NullPointerException</code> ，而 <code>map()</code> 返回EMPTY。</p><h4 id=判断-value-是否为-null>判断 value 是否为 null
<a class=anchor href=#%e5%88%a4%e6%96%ad-value-%e6%98%af%e5%90%a6%e4%b8%ba-null>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* value是否为null
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>isPresent</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> value <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 如果value不为null执行consumer.accept
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>ifPresent</span><span style=color:#f92672>(</span>Consumer<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>super</span> T<span style=color:#f92672>&gt;</span> consumer<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>value <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    consumer<span style=color:#f92672>.</span><span style=color:#a6e22e>accept</span><span style=color:#f92672>(</span>value<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=获取-value>获取 value
<a class=anchor href=#%e8%8e%b7%e5%8f%96-value>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* Return the value if present, otherwise invoke {@code other} and return
</span></span></span><span style=display:flex><span><span style=color:#75715e>* the result of that invocation.
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 如果value != null 返回value，否则返回other的执行结果
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> T <span style=color:#a6e22e>orElseGet</span><span style=color:#f92672>(</span>Supplier<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>extends</span> T<span style=color:#f92672>&gt;</span> other<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> value <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>?</span> value <span style=color:#f92672>:</span> other<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 如果value != null 返回value，否则返回T
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> T <span style=color:#a6e22e>orElse</span><span style=color:#f92672>(</span>T other<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> value <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>?</span> value <span style=color:#f92672>:</span> other<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 如果value != null 返回value，否则抛出参数返回的异常
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#f92672>&lt;</span>X <span style=color:#66d9ef>extends</span> Throwable<span style=color:#f92672>&gt;</span> T <span style=color:#a6e22e>orElseThrow</span><span style=color:#f92672>(</span>Supplier<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>extends</span> X<span style=color:#f92672>&gt;</span> exceptionSupplier<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> X <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>value <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> value<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> exceptionSupplier<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* value为null抛出NoSuchElementException，不为空返回value。
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> T <span style=color:#a6e22e>get</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>value <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> NoSuchElementException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;No value present&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> value<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=过滤值>过滤值
<a class=anchor href=#%e8%bf%87%e6%bb%a4%e5%80%bc>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 1. 如果是empty返回empty
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 2. predicate.test(value)==true 返回this，否则返回empty
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> Optional<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>Predicate<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>super</span> T<span style=color:#f92672>&gt;</span> predicate<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Objects<span style=color:#f92672>.</span><span style=color:#a6e22e>requireNonNull</span><span style=color:#f92672>(</span>predicate<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>isPresent<span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> predicate<span style=color:#f92672>.</span><span style=color:#a6e22e>test</span><span style=color:#f92672>(</span>value<span style=color:#f92672>)</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span> <span style=color:#f92672>:</span> empty<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=date-time-api>Date-Time API
<a class=anchor href=#date-time-api>#</a></h3><p>这是对 <code>java.util.Date</code> 强有力的补充，解决了 Date 类的大部分痛点：</p><ol><li>非线程安全</li><li>时区处理麻烦</li><li>各种格式化、和时间计算繁琐</li><li>设计有缺陷，Date 类同时包含日期和时间；还有一个 java.sql.Date，容易混淆。</li></ol><p>我们从常用的时间实例来对比 java.util.Date 和新 Date 有什么区别。用 <code>java.util.Date</code> 的代码该改改了。</p><h4 id=javatime-主要类>java.time 主要类
<a class=anchor href=#javatime-%e4%b8%bb%e8%a6%81%e7%b1%bb>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>LocalDateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span> <span style=color:#75715e>//日期+时间 format: yyyy-MM-ddTHH:mm:ss.SSS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>LocalDate<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span> <span style=color:#75715e>//日期 format: yyyy-MM-dd
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>LocalTime<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span> <span style=color:#75715e>//时间 format: HH:mm:ss
</span></span></span></code></pre></div><h4 id=格式化>格式化
<a class=anchor href=#%e6%a0%bc%e5%bc%8f%e5%8c%96>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>newFormat</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//format yyyy-MM-dd
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate date <span style=color:#f92672>=</span> LocalDate<span style=color:#f92672>.</span><span style=color:#a6e22e>now</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;date format : %s&#34;</span><span style=color:#f92672>,</span> date<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//format HH:mm:ss
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalTime time <span style=color:#f92672>=</span> LocalTime<span style=color:#f92672>.</span><span style=color:#a6e22e>now</span><span style=color:#f92672>().</span><span style=color:#a6e22e>withNano</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;time format : %s&#34;</span><span style=color:#f92672>,</span> time<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//format yyyy-MM-dd HH:mm:ss
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDateTime dateTime <span style=color:#f92672>=</span> LocalDateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>now</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    DateTimeFormatter dateTimeFormatter <span style=color:#f92672>=</span> DateTimeFormatter<span style=color:#f92672>.</span><span style=color:#a6e22e>ofPattern</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;yyyy-MM-dd HH:mm:ss&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    String dateTimeStr <span style=color:#f92672>=</span> dateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span>dateTimeFormatter<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;dateTime format : %s&#34;</span><span style=color:#f92672>,</span> dateTimeStr<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=字符串转日期格式>字符串转日期格式
<a class=anchor href=#%e5%ad%97%e7%ac%a6%e4%b8%b2%e8%bd%ac%e6%97%a5%e6%9c%9f%e6%a0%bc%e5%bc%8f>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>LocalDate date <span style=color:#f92672>=</span> LocalDate<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>2021<span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> 26<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>LocalDate<span style=color:#f92672>.</span><span style=color:#a6e22e>parse</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;2021-01-26&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LocalDateTime dateTime <span style=color:#f92672>=</span> LocalDateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>2021<span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> 26<span style=color:#f92672>,</span> 12<span style=color:#f92672>,</span> 12<span style=color:#f92672>,</span> 22<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>LocalDateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>parse</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;2021-01-26 12:12:22&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LocalTime time <span style=color:#f92672>=</span> LocalTime<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>12<span style=color:#f92672>,</span> 12<span style=color:#f92672>,</span> 22<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>LocalTime<span style=color:#f92672>.</span><span style=color:#a6e22e>parse</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;12:12:22&#34;</span><span style=color:#f92672>);</span>
</span></span></code></pre></div><h4 id=日期计算>日期计算
<a class=anchor href=#%e6%97%a5%e6%9c%9f%e8%ae%a1%e7%ae%97>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>pushWeek</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//一周后的日期
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate localDate <span style=color:#f92672>=</span> LocalDate<span style=color:#f92672>.</span><span style=color:#a6e22e>now</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//方法1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate after <span style=color:#f92672>=</span> localDate<span style=color:#f92672>.</span><span style=color:#a6e22e>plus</span><span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> ChronoUnit<span style=color:#f92672>.</span><span style=color:#a6e22e>WEEKS</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//方法2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate after2 <span style=color:#f92672>=</span> localDate<span style=color:#f92672>.</span><span style=color:#a6e22e>plusWeeks</span><span style=color:#f92672>(</span>1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;一周后日期：&#34;</span> <span style=color:#f92672>+</span> after<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//算两个日期间隔多少天，计算间隔多少年，多少月
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate date1 <span style=color:#f92672>=</span> LocalDate<span style=color:#f92672>.</span><span style=color:#a6e22e>parse</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;2021-02-26&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    LocalDate date2 <span style=color:#f92672>=</span> LocalDate<span style=color:#f92672>.</span><span style=color:#a6e22e>parse</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;2021-12-23&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    Period period <span style=color:#f92672>=</span> Period<span style=color:#f92672>.</span><span style=color:#a6e22e>between</span><span style=color:#f92672>(</span>date1<span style=color:#f92672>,</span> date2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;date1 到 date2 相隔：&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#f92672>+</span> period<span style=color:#f92672>.</span><span style=color:#a6e22e>getYears</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;年&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#f92672>+</span> period<span style=color:#f92672>.</span><span style=color:#a6e22e>getMonths</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;月&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#f92672>+</span> period<span style=color:#f92672>.</span><span style=color:#a6e22e>getDays</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;天&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//打印结果是 “date1 到 date2 相隔：0年9月27天”
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//这里period.getDays()得到的天是抛去年月以外的天数，并不是总天数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//如果要获取纯粹的总天数应该用下面的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>long</span> day <span style=color:#f92672>=</span> date2<span style=color:#f92672>.</span><span style=color:#a6e22e>toEpochDay</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> date1<span style=color:#f92672>.</span><span style=color:#a6e22e>toEpochDay</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>date2 <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;和&#34;</span> <span style=color:#f92672>+</span> date2 <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;相差&#34;</span> <span style=color:#f92672>+</span> day <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;天&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//打印结果：2021-12-23和2021-12-23相差300天
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=获取指定日期>获取指定日期
<a class=anchor href=#%e8%8e%b7%e5%8f%96%e6%8c%87%e5%ae%9a%e6%97%a5%e6%9c%9f>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>getDayNew</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    LocalDate today <span style=color:#f92672>=</span> LocalDate<span style=color:#f92672>.</span><span style=color:#a6e22e>now</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//获取当前月第一天：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate firstDayOfThisMonth <span style=color:#f92672>=</span> today<span style=color:#f92672>.</span><span style=color:#a6e22e>with</span><span style=color:#f92672>(</span>TemporalAdjusters<span style=color:#f92672>.</span><span style=color:#a6e22e>firstDayOfMonth</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 取本月最后一天
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate lastDayOfThisMonth <span style=color:#f92672>=</span> today<span style=color:#f92672>.</span><span style=color:#a6e22e>with</span><span style=color:#f92672>(</span>TemporalAdjusters<span style=color:#f92672>.</span><span style=color:#a6e22e>lastDayOfMonth</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//取下一天：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate nextDay <span style=color:#f92672>=</span> lastDayOfThisMonth<span style=color:#f92672>.</span><span style=color:#a6e22e>plusDays</span><span style=color:#f92672>(</span>1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//当年最后一天
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate lastday <span style=color:#f92672>=</span> today<span style=color:#f92672>.</span><span style=color:#a6e22e>with</span><span style=color:#f92672>(</span>TemporalAdjusters<span style=color:#f92672>.</span><span style=color:#a6e22e>lastDayOfYear</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//2021年最后一个周日，如果用Calendar是不得烦死。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LocalDate lastMondayOf2021 <span style=color:#f92672>=</span> LocalDate<span style=color:#f92672>.</span><span style=color:#a6e22e>parse</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;2021-12-31&#34;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>with</span><span style=color:#f92672>(</span>TemporalAdjusters<span style=color:#f92672>.</span><span style=color:#a6e22e>lastInMonth</span><span style=color:#f92672>(</span>DayOfWeek<span style=color:#f92672>.</span><span style=color:#a6e22e>SUNDAY</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=时区>时区
<a class=anchor href=#%e6%97%b6%e5%8c%ba>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>//当前时区时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ZonedDateTime zonedDateTime <span style=color:#f92672>=</span> ZonedDateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>now</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;当前时区时间: &#34;</span> <span style=color:#f92672>+</span> zonedDateTime<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//东京时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ZoneId zoneId <span style=color:#f92672>=</span> ZoneId<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>ZoneId<span style=color:#f92672>.</span><span style=color:#a6e22e>SHORT_IDS</span><span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;JST&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>ZonedDateTime tokyoTime <span style=color:#f92672>=</span> zonedDateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>withZoneSameInstant</span><span style=color:#f92672>(</span>zoneId<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;东京时间: &#34;</span> <span style=color:#f92672>+</span> tokyoTime<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ZonedDateTime 转 LocalDateTime
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>LocalDateTime localDateTime <span style=color:#f92672>=</span> tokyoTime<span style=color:#f92672>.</span><span style=color:#a6e22e>toLocalDateTime</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;东京时间转当地时间: &#34;</span> <span style=color:#f92672>+</span> localDateTime<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//LocalDateTime 转 ZonedDateTime
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ZonedDateTime localZoned <span style=color:#f92672>=</span> localDateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>atZone</span><span style=color:#f92672>(</span>ZoneId<span style=color:#f92672>.</span><span style=color:#a6e22e>systemDefault</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;本地时区时间: &#34;</span> <span style=color:#f92672>+</span> localZoned<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//打印结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>当前时区时间: 2021<span style=color:#f92672>-</span>01<span style=color:#f92672>-</span>27T14<span style=color:#f92672>:</span>43<span style=color:#f92672>:</span>58<span style=color:#f92672>.</span><span style=color:#a6e22e>735</span><span style=color:#f92672>+</span>08<span style=color:#f92672>:</span>00<span style=color:#f92672>[</span>Asia<span style=color:#f92672>/</span>Shanghai<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>东京时间: 2021<span style=color:#f92672>-</span>01<span style=color:#f92672>-</span>27T15<span style=color:#f92672>:</span>43<span style=color:#f92672>:</span>58<span style=color:#f92672>.</span><span style=color:#a6e22e>735</span><span style=color:#f92672>+</span>09<span style=color:#f92672>:</span>00<span style=color:#f92672>[</span>Asia<span style=color:#f92672>/</span>Tokyo<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>东京时间转当地时间: 2021<span style=color:#f92672>-</span>01<span style=color:#f92672>-</span>27T15<span style=color:#f92672>:</span>43<span style=color:#f92672>:</span>58<span style=color:#f92672>.</span><span style=color:#a6e22e>735</span>
</span></span><span style=display:flex><span>当地时区时间: 2021<span style=color:#f92672>-</span>01<span style=color:#f92672>-</span>27T15<span style=color:#f92672>:</span>53<span style=color:#f92672>:</span>35<span style=color:#f92672>.</span><span style=color:#a6e22e>618</span><span style=color:#f92672>+</span>08<span style=color:#f92672>:</span>00<span style=color:#f92672>[</span>Asia<span style=color:#f92672>/</span>Shanghai<span style=color:#f92672>]</span>
</span></span></code></pre></div><h2 id=java-9>Java 9
<a class=anchor href=#java-9>#</a></h2><h3 id=jshell>JShell
<a class=anchor href=#jshell>#</a></h3><p>JShell 是 Java 9 新增的一个实用工具。为 Java 提供了类似于 Python 的实时命令行交互工具。
可以在终端使用 <code>jshell</code> 命令进入。</p><h3 id=模块化系统>模块化系统
<a class=anchor href=#%e6%a8%a1%e5%9d%97%e5%8c%96%e7%b3%bb%e7%bb%9f>#</a></h3><p>什么是模块系统？
简单来说，你可以将一个模块看作是一组唯一命名、可重用的包、资源和模块描述文件（module-info.java）。
任意一个 jar 文件，只要加上一个模块描述文件（module-info.java），就可以升级为一个模块。</p><p>在引入了模块系统之后，JDK 被重新组织成 94 个模块。Java 应用可以通过新增的 jlinkopen in new window 工具 (Jlink 是随 Java 9 一起发布的新命令行工具。它允许开发人员为基于模块的 Java 应用程序创建自己的轻量级、定制的 JRE)，创建出只包含所依赖的 JDK 模块的自定义运行时镜像。这样可以极大的减少 Java 运行时环境的大小。</p><p>在JDK 9中，您可以如下声明这两个模块：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>module policy <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    exports pkg1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>module claim <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    requires policy<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>我们可以通过 <code>exports</code> 关键词精准控制哪些类可以对外开放使用，哪些类只能内部使用。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>module my<span style=color:#f92672>.</span><span style=color:#a6e22e>module</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//exports 公开指定包的所有公共成员
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    exports com<span style=color:#f92672>.</span><span style=color:#a6e22e>my</span><span style=color:#f92672>.</span><span style=color:#a6e22e>package</span><span style=color:#f92672>.</span><span style=color:#a6e22e>name</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>module my<span style=color:#f92672>.</span><span style=color:#a6e22e>module</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>//exports…to 限制访问的成员范围
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    export com<span style=color:#f92672>.</span><span style=color:#a6e22e>my</span><span style=color:#f92672>.</span><span style=color:#a6e22e>package</span><span style=color:#f92672>.</span><span style=color:#a6e22e>name</span> to com<span style=color:#f92672>.</span><span style=color:#a6e22e>specific</span><span style=color:#f92672>.</span><span style=color:#a6e22e>package</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>具体地，参考：
<a href=https://www.cnblogs.com/IcanFixIt/p/6947763.html>Java 9 揭秘（2. 模块化系统）</a></p><h3 id=快速创建不可变集合>快速创建<em>不可变集合</em>
<a class=anchor href=#%e5%bf%ab%e9%80%9f%e5%88%9b%e5%bb%ba%e4%b8%8d%e5%8f%af%e5%8f%98%e9%9b%86%e5%90%88>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>List<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Java&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;C++&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>Set<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Java&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;C++&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>Map<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Java&#34;</span><span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;C++&#34;</span><span style=color:#f92672>,</span> 2<span style=color:#f92672>);</span>
</span></span></code></pre></div><h3 id=接口私有方法>接口私有方法
<a class=anchor href=#%e6%8e%a5%e5%8f%a3%e7%a7%81%e6%9c%89%e6%96%b9%e6%b3%95>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>MyInterface</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>methodPrivate</span><span style=color:#f92672>(){</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=try-with-resources-增强>try-with-resources 增强
<a class=anchor href=#try-with-resources-%e5%a2%9e%e5%bc%ba>#</a></h3><p>在 Java 9 之前，我们只能在 <code>try-with-resources</code> 块中声明变量：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>try</span> <span style=color:#f92672>(</span>Scanner scanner <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Scanner<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> File<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;testRead.txt&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    PrintWriter writer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PrintWriter<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> File<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;testWrite.txt&#34;</span><span style=color:#f92672>)))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// omitted
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>在 Java 9 之后，在 <code>try-with-resources</code> 语句中可以使用 effectively-final 变量。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>final</span> Scanner scanner <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Scanner<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> File<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;testRead.txt&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>PrintWriter writer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PrintWriter<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> File<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;testWrite.txt&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> <span style=color:#f92672>(</span>scanner<span style=color:#f92672>;</span>writer<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// omitted
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>什么是 effectively-final 变量？ 简单来说就是没有被 <code>final</code> 修饰但是值在初始化后从未更改的变量。</p><p>正如上面的代码所演示的那样，即使 <code>writer</code> 变量没有被显示声明为 <code>final</code> ，但它在第一次被赋值后就不会改变了，因此，它就是 effectively-final 变量。</p><h3 id=stream--optional-增强>Stream & Optional 增强
<a class=anchor href=#stream--optional-%e5%a2%9e%e5%bc%ba>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// Stream
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ofNullable()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Stream<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> stringStream <span style=color:#f92672>=</span> Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>ofNullable</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Java&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>stringStream<span style=color:#f92672>.</span><span style=color:#a6e22e>count</span><span style=color:#f92672>());</span><span style=color:#75715e>// 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Stream<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> nullStream <span style=color:#f92672>=</span> Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>ofNullable</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>nullStream<span style=color:#f92672>.</span><span style=color:#a6e22e>count</span><span style=color:#f92672>());</span><span style=color:#75715e>//0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// takeWhile()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>List<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> integerList <span style=color:#f92672>=</span> List<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>11<span style=color:#f92672>,</span> 33<span style=color:#f92672>,</span> 66<span style=color:#f92672>,</span> 8<span style=color:#f92672>,</span> 9<span style=color:#f92672>,</span> 13<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>integerList<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>takeWhile</span><span style=color:#f92672>(</span>x <span style=color:#f92672>-&gt;</span> x <span style=color:#f92672>&lt;</span> 50<span style=color:#f92672>).</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>::</span>println<span style=color:#f92672>);</span><span style=color:#75715e>// 11 33
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// dropWhile()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>List<span style=color:#f92672>&lt;</span>Integer<span style=color:#f92672>&gt;</span> integerList2 <span style=color:#f92672>=</span> List<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>11<span style=color:#f92672>,</span> 33<span style=color:#f92672>,</span> 66<span style=color:#f92672>,</span> 8<span style=color:#f92672>,</span> 9<span style=color:#f92672>,</span> 13<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>integerList2<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>dropWhile</span><span style=color:#f92672>(</span>x <span style=color:#f92672>-&gt;</span> x <span style=color:#f92672>&lt;</span> 50<span style=color:#f92672>).</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>::</span>println<span style=color:#f92672>);</span><span style=color:#75715e>// 66 8 9 13
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// iterate()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> Stream<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>iterate</span><span style=color:#f92672>(</span><span style=color:#66d9ef>final</span> T seed<span style=color:#f92672>,</span> <span style=color:#66d9ef>final</span> UnaryOperator<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> f<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 新增加的重载方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> Stream<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>iterate</span><span style=color:#f92672>(</span>T seed<span style=color:#f92672>,</span> Predicate<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>super</span> T<span style=color:#f92672>&gt;</span> hasNext<span style=color:#f92672>,</span> UnaryOperator<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> next<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用原始 iterate() 方法输出数字 1~10
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>iterate</span><span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> i <span style=color:#f92672>-&gt;</span> i <span style=color:#f92672>+</span> 1<span style=color:#f92672>).</span><span style=color:#a6e22e>limit</span><span style=color:#f92672>(</span>10<span style=color:#f92672>).</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>::</span>println<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用新的 iterate() 重载方法输出数字 1~10
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>iterate</span><span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> i <span style=color:#f92672>-&gt;</span> i <span style=color:#f92672>&lt;=</span> 10<span style=color:#f92672>,</span> i <span style=color:#f92672>-&gt;</span> i <span style=color:#f92672>+</span> 1<span style=color:#f92672>).</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>::</span>println<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Optional
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ifPresentOrElse()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>ifPresentOrElse</span><span style=color:#f92672>(</span>Consumer<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>super</span> T<span style=color:#f92672>&gt;</span> action<span style=color:#f92672>,</span> Runnable emptyAction<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Optional<span style=color:#f92672>&lt;</span>Object<span style=color:#f92672>&gt;</span> objectOptional <span style=color:#f92672>=</span> Optional<span style=color:#f92672>.</span><span style=color:#a6e22e>empty</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>objectOptional<span style=color:#f92672>.</span><span style=color:#a6e22e>ifPresentOrElse</span><span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>::</span>println<span style=color:#f92672>,</span> <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Empty!!!&#34;</span><span style=color:#f92672>));</span><span style=color:#75715e>// Empty!!!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// or()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> Optional<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>or</span><span style=color:#f92672>(</span>Supplier<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>extends</span> Optional<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>extends</span> T<span style=color:#f92672>&gt;&gt;</span> supplier<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Optional<span style=color:#f92672>&lt;</span>Object<span style=color:#f92672>&gt;</span> objectOptional <span style=color:#f92672>=</span> Optional<span style=color:#f92672>.</span><span style=color:#a6e22e>empty</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>objectOptional<span style=color:#f92672>.</span><span style=color:#a6e22e>or</span><span style=color:#f92672>(()</span> <span style=color:#f92672>-&gt;</span> Optional<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;java&#34;</span><span style=color:#f92672>)).</span><span style=color:#a6e22e>ifPresent</span><span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>::</span>println<span style=color:#f92672>);</span><span style=color:#75715e>//java
</span></span></span></code></pre></div><h3 id=进程-api>进程 API
<a class=anchor href=#%e8%bf%9b%e7%a8%8b-api>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// java.lang.ProcessHandle
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 获取当前正在运行的 JVM 的进程
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ProcessHandle currentProcess <span style=color:#f92672>=</span> ProcessHandle<span style=color:#f92672>.</span><span style=color:#a6e22e>current</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 输出进程的 id
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>currentProcess<span style=color:#f92672>.</span><span style=color:#a6e22e>pid</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 输出进程的信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>currentProcess<span style=color:#f92672>.</span><span style=color:#a6e22e>info</span><span style=color:#f92672>());</span>
</span></span></code></pre></div><h2 id=java-10>Java 10
<a class=anchor href=#java-10>#</a></h2><h3 id=局部变量类型推断var>局部变量类型推断(var)
<a class=anchor href=#%e5%b1%80%e9%83%a8%e5%8f%98%e9%87%8f%e7%b1%bb%e5%9e%8b%e6%8e%a8%e6%96%advar>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>var id <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>var codefx <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> URL<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;https://mp.weixin.qq.com/&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>var list <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>var list <span style=color:#f92672>=</span> List<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> 2<span style=color:#f92672>,</span> 3<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>var map <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;();</span>
</span></span><span style=display:flex><span>var p <span style=color:#f92672>=</span> Paths<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;src/test/java/Java9FeaturesTest.java&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>var numbers <span style=color:#f92672>=</span> List<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;b&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;c&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>var n <span style=color:#f92672>:</span> list<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>print</span><span style=color:#f92672>(</span>n<span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>var count<span style=color:#f92672>=</span><span style=color:#66d9ef>null</span><span style=color:#f92672>;</span> <span style=color:#75715e>//❌编译不通过，不能声明为 null
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>var r <span style=color:#f92672>=</span> <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> Math<span style=color:#f92672>.</span><span style=color:#a6e22e>random</span><span style=color:#f92672>();</span><span style=color:#75715e>//❌编译不通过,不能声明为 Lambda表达式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>var array <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>1<span style=color:#f92672>,</span>2<span style=color:#f92672>,</span>3<span style=color:#f92672>};</span><span style=color:#75715e>//❌编译不通过,不能声明数组
</span></span></span></code></pre></div><p>var 并不会改变 Java 是一门静态类型语言的事实，编译器负责推断出类型。</p><h3 id=集合增强>集合增强
<a class=anchor href=#%e9%9b%86%e5%90%88%e5%a2%9e%e5%bc%ba>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// List，Set，Map 提供了静态方法copyOf()返回入参集合的一个不可变拷贝
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>static</span> <span style=color:#f92672>&lt;</span>E<span style=color:#f92672>&gt;</span> List<span style=color:#f92672>&lt;</span>E<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>copyOf</span><span style=color:#f92672>(</span>Collection<span style=color:#f92672>&lt;?</span> <span style=color:#66d9ef>extends</span> E<span style=color:#f92672>&gt;</span> coll<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ImmutableCollections<span style=color:#f92672>.</span><span style=color:#a6e22e>listCopy</span><span style=color:#f92672>(</span>coll<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// java.util.stream.Collectors 中新增了静态方法，用于将流中的元素收集为不可变的集合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>var list <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>list<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>toUnmodifiableList</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>list<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>().</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>toUnmodifiableSet</span><span style=color:#f92672>());</span>
</span></span></code></pre></div><h3 id=optional-增强>Optional 增强
<a class=anchor href=#optional-%e5%a2%9e%e5%bc%ba>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// Optional 新增了orElseThrow()方法来在没有值时抛出指定的异常
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Optional<span style=color:#f92672>.</span><span style=color:#a6e22e>ofNullable</span><span style=color:#f92672>(</span>cache<span style=color:#f92672>.</span><span style=color:#a6e22e>getIfPresent</span><span style=color:#f92672>(</span>key<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>.</span><span style=color:#a6e22e>orElseThrow</span><span style=color:#f92672>(()</span> <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>new</span> PrestoException<span style=color:#f92672>(</span>NOT_FOUND<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Missing entry found for key: &#34;</span> <span style=color:#f92672>+</span> key<span style=color:#f92672>));</span>
</span></span></code></pre></div><h2 id=java-11>Java 11
<a class=anchor href=#java-11>#</a></h2><h3 id=http-client-标准化>HTTP Client 标准化
<a class=anchor href=#http-client-%e6%a0%87%e5%87%86%e5%8c%96>#</a></h3><p>这里建议使用第三方库 <code>com.squareup.okhttp3</code> ，这里就不再过多介绍原生API。</p><h3 id=string-增强>String 增强
<a class=anchor href=#string-%e5%a2%9e%e5%bc%ba>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>//判断字符串是否为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#34; &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>isBlank</span><span style=color:#f92672>();</span><span style=color:#75715e>//true
</span></span></span><span style=display:flex><span><span style=color:#75715e>//去除字符串首尾空格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#34; Java &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>strip</span><span style=color:#f92672>();</span><span style=color:#75715e>// &#34;Java&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>//去除字符串首部空格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#34; Java &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>stripLeading</span><span style=color:#f92672>();</span>   <span style=color:#75715e>// &#34;Java &#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>//去除字符串尾部空格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#34; Java &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>stripTrailing</span><span style=color:#f92672>();</span>  <span style=color:#75715e>// &#34; Java&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>//重复字符串多少次
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#34;Java&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>repeat</span><span style=color:#f92672>(</span>3<span style=color:#f92672>);</span>             <span style=color:#75715e>// &#34;JavaJavaJava&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>//返回由行终止符分隔的字符串集合。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#34;A\nB\nC&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>lines</span><span style=color:#f92672>().</span><span style=color:#a6e22e>count</span><span style=color:#f92672>();</span>    <span style=color:#75715e>// 3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#34;A\nB\nC&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>lines</span><span style=color:#f92672>().</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>toList</span><span style=color:#f92672>());</span>
</span></span></code></pre></div><h3 id=optional-增强-1>Optional 增强
<a class=anchor href=#optional-%e5%a2%9e%e5%bc%ba-1>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 新增了empty()方法来判断指定的 Optional 对象是否为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>var op <span style=color:#f92672>=</span> Optional<span style=color:#f92672>.</span><span style=color:#a6e22e>empty</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>op<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>());</span><span style=color:#75715e>//判断指定的 Optional 对象是否为空
</span></span></span></code></pre></div><h3 id=lambda-参数的局部变量语法>Lambda 参数的局部变量语法
<a class=anchor href=#lambda-%e5%8f%82%e6%95%b0%e7%9a%84%e5%b1%80%e9%83%a8%e5%8f%98%e9%87%8f%e8%af%ad%e6%b3%95>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// Java11 开始允许开发者在 Lambda 表达式中使用 var 进行参数声明
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 下面两者是等价的
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Consumer<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> consumer <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>var i<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>i<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>Consumer<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> consumer <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>String i<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>i<span style=color:#f92672>);</span>
</span></span></code></pre></div><h2 id=java-12>Java 12
<a class=anchor href=#java-12>#</a></h2><h3 id=string-增强-1>String 增强
<a class=anchor href=#string-%e5%a2%9e%e5%bc%ba-1>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// indent() 方法可以实现字符串缩进
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>String text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Java&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 缩进 4 格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>text <span style=color:#f92672>=</span> text<span style=color:#f92672>.</span><span style=color:#a6e22e>indent</span><span style=color:#f92672>(</span>4<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>text<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>text <span style=color:#f92672>=</span> text<span style=color:#f92672>.</span><span style=color:#a6e22e>indent</span><span style=color:#f92672>(-</span>10<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>text<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// output
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Java
</span></span><span style=display:flex><span>Java
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// transform() 方法可以用来转变指定字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>String result <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;foo&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>transform</span><span style=color:#f92672>(</span>input <span style=color:#f92672>-&gt;</span> input <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; bar&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>result<span style=color:#f92672>);</span> <span style=color:#75715e>// foo bar
</span></span></span></code></pre></div><h3 id=files-增强文件比较>Files 增强（文件比较）
<a class=anchor href=#files-%e5%a2%9e%e5%bc%ba%e6%96%87%e4%bb%b6%e6%af%94%e8%be%83>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// mismatch() 方法用于比较两个文件，并返回第一个不匹配字符的位置，如果文件相同则返回 -1L
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Path filePath1 <span style=color:#f92672>=</span> Files<span style=color:#f92672>.</span><span style=color:#a6e22e>createTempFile</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;file1&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;.txt&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>Path filePath2 <span style=color:#f92672>=</span> Files<span style=color:#f92672>.</span><span style=color:#a6e22e>createTempFile</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;file2&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;.txt&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>Files<span style=color:#f92672>.</span><span style=color:#a6e22e>writeString</span><span style=color:#f92672>(</span>filePath1<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Java 12 Article&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>Files<span style=color:#f92672>.</span><span style=color:#a6e22e>writeString</span><span style=color:#f92672>(</span>filePath2<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Java 12 Article&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>long</span> mismatch <span style=color:#f92672>=</span> Files<span style=color:#f92672>.</span><span style=color:#a6e22e>mismatch</span><span style=color:#f92672>(</span>filePath1<span style=color:#f92672>,</span> filePath2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>assertEquals<span style=color:#f92672>(-</span>1<span style=color:#f92672>,</span> mismatch<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 不相同
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Path filePath3 <span style=color:#f92672>=</span> Files<span style=color:#f92672>.</span><span style=color:#a6e22e>createTempFile</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;file3&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;.txt&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>Path filePath4 <span style=color:#f92672>=</span> Files<span style=color:#f92672>.</span><span style=color:#a6e22e>createTempFile</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;file4&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;.txt&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>Files<span style=color:#f92672>.</span><span style=color:#a6e22e>writeString</span><span style=color:#f92672>(</span>filePath3<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Java 12 Article&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>Files<span style=color:#f92672>.</span><span style=color:#a6e22e>writeString</span><span style=color:#f92672>(</span>filePath4<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Java 12 Tutorial&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>long</span> mismatch <span style=color:#f92672>=</span> Files<span style=color:#f92672>.</span><span style=color:#a6e22e>mismatch</span><span style=color:#f92672>(</span>filePath3<span style=color:#f92672>,</span> filePath4<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>assertEquals<span style=color:#f92672>(</span>8<span style=color:#f92672>,</span> mismatch<span style=color:#f92672>);</span>
</span></span></code></pre></div><h3 id=数字格式化工具类>数字格式化工具类
<a class=anchor href=#%e6%95%b0%e5%ad%97%e6%a0%bc%e5%bc%8f%e5%8c%96%e5%b7%a5%e5%85%b7%e7%b1%bb>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// NumberFormat 新增了对复杂的数字进行格式化的支持
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>NumberFormat fmt <span style=color:#f92672>=</span> NumberFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>getCompactNumberInstance</span><span style=color:#f92672>(</span>Locale<span style=color:#f92672>.</span><span style=color:#a6e22e>US</span><span style=color:#f92672>,</span> NumberFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>Style</span><span style=color:#f92672>.</span><span style=color:#a6e22e>SHORT</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>String result <span style=color:#f92672>=</span> fmt<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span>1000<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>result<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// output
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>1K
</span></span></code></pre></div><h2 id=java-13>Java 13
<a class=anchor href=#java-13>#</a></h2><h3 id=socketapi-重构>SocketAPI 重构
<a class=anchor href=#socketapi-%e9%87%8d%e6%9e%84>#</a></h3><p>Java 13 将 Socket API 的底层进行了重写， <code>NioSocketImpl</code> 是对 <code>PlainSocketImpl</code> 的直接替代，它使用 <code>java.util.concurrent</code> 包下的锁而不是同步方法。如果要使用旧实现，请使用 <code>-Djdk.net.usePlainSocketImpl=true</code> 。</p><p>并且，在 Java 13 中是默认使用新的 Socket 实现。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NioSocketImpl</span> <span style=color:#66d9ef>extends</span> SocketImpl <span style=color:#66d9ef>implements</span> PlatformSocketImpl <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=filesystems>FileSystems
<a class=anchor href=#filesystems>#</a></h3><p><code>FileSystems</code> 类中添加了以下三种新方法，以便更容易地使用将文件内容视为文件系统的文件系统提供程序：</p><ul><li><code>newFileSystem(Path)</code></li><li><code>newFileSystem(Path, Map&lt;String, ?>)</code></li><li><code>newFileSystem(Path, Map&lt;String, ?>, ClassLoader)</code></li></ul><h2 id=java-14>Java 14
<a class=anchor href=#java-14>#</a></h2><h3 id=空指针异常精准提示>空指针异常精准提示
<a class=anchor href=#%e7%a9%ba%e6%8c%87%e9%92%88%e5%bc%82%e5%b8%b8%e7%b2%be%e5%87%86%e6%8f%90%e7%a4%ba>#</a></h3><p>通过 JVM 参数中添加 <code>-XX:+ShowCodeDetailsInExceptionMessages</code> ，可以在空指针异常中获取更为详细的调用信息，更快的定位和解决问题。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>a<span style=color:#f92672>.</span><span style=color:#a6e22e>b</span><span style=color:#f92672>.</span><span style=color:#a6e22e>c</span><span style=color:#f92672>.</span><span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> 99<span style=color:#f92672>;</span> <span style=color:#75715e>// 假设这段代码会发生空指针
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 增加参数后提示的异常中很明确的告知了哪里为空导致
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Exception in thread <span style=color:#e6db74>&#34;main&#34;</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>lang</span><span style=color:#f92672>.</span><span style=color:#a6e22e>NullPointerException</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        Cannot read field <span style=color:#e6db74>&#39;c&#39;</span> because <span style=color:#960050;background-color:#1e0010>&#39;</span>a<span style=color:#f92672>.</span><span style=color:#a6e22e>b</span><span style=color:#960050;background-color:#1e0010>&#39;</span> is <span style=color:#66d9ef>null</span><span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>    at Prog<span style=color:#f92672>.</span><span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>Prog<span style=color:#f92672>.</span><span style=color:#a6e22e>java</span><span style=color:#f92672>:</span>5<span style=color:#f92672>)</span>
</span></span></code></pre></div><h3 id=switch-的增强>switch 的增强
<a class=anchor href=#switch-%e7%9a%84%e5%a2%9e%e5%bc%ba>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 传统的 switch 语法存在容易漏写 break 的问题，而且从代码整洁性层面来看，多个 break 本质也是一种重复
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Java12 增强了 swtich 表达式，使用类似 lambda 语法条件匹配成功后的执行块，不需要多写 break
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>switch</span> <span style=color:#f92672>(</span>day<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> MONDAY<span style=color:#f92672>,</span> FRIDAY<span style=color:#f92672>,</span> SUNDAY <span style=color:#f92672>-&gt;</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>6<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> TUESDAY                <span style=color:#f92672>-&gt;</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>7<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> THURSDAY<span style=color:#f92672>,</span> SATURDAY     <span style=color:#f92672>-&gt;</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>8<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> WEDNESDAY              <span style=color:#f92672>-&gt;</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>9<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Java 13 中 Switch 表达式中多了一个关键字用于跳出 Switch 块的关键字 yield，主要用于返回一个值
</span></span></span><span style=display:flex><span><span style=color:#75715e>// yield和 return 的区别在于：return 会直接跳出当前循环或者方法，而 yield 只会跳出当前 Switch 块，同时在使用 yield 时，需要有 default 条件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ex1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>String result <span style=color:#f92672>=</span> <span style=color:#66d9ef>switch</span> <span style=color:#f92672>(</span>day<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;M&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;W&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;F&#34;</span> <span style=color:#f92672>-&gt;</span> <span style=color:#e6db74>&#34;MWF&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;T&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;TH&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;S&#34;</span> <span style=color:#f92672>-&gt;</span> <span style=color:#e6db74>&#34;TTS&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>default</span> <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>day<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>                    yield <span style=color:#e6db74>&#34;Please insert a valid day.&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>                    yield <span style=color:#e6db74>&#34;Looks like a Sunday.&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>result<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ex2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>descLanguage</span><span style=color:#f92672>(</span>String name<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>switch</span> <span style=color:#f92672>(</span>name<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;Java&#34;</span><span style=color:#f92672>:</span> yield <span style=color:#e6db74>&#34;object-oriented, platform independent and secured&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;Ruby&#34;</span><span style=color:#f92672>:</span> yield <span style=color:#e6db74>&#34;a programmer&#39;s best friend&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span> yield name <span style=color:#f92672>+</span><span style=color:#e6db74>&#34; is a good language&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=java-15>Java 15
<a class=anchor href=#java-15>#</a></h2><h3 id=charsequence>CharSequence
<a class=anchor href=#charsequence>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// CharSequence 接口添加了一个默认方法 isEmpty() 来判断字符序列为空，如果是则返回 true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>CharSequence</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>()</span> <span style=color:#f92672>==</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=treemap>TreeMap
<a class=anchor href=#treemap>#</a></h3><p><code>TreeMap</code> 新引入了下面这些方法：</p><ul><li><code>putIfAbsent()</code></li><li><code>computeIfAbsent()</code></li><li><code>computeIfPresent()</code></li><li><code>compute()</code></li><li><code>merge()</code></li></ul><h3 id=eddsa数字签名算法>EdDSA(数字签名算法)
<a class=anchor href=#eddsa%e6%95%b0%e5%ad%97%e7%ad%be%e5%90%8d%e7%ae%97%e6%b3%95>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 新加入了一个安全性和性能都更强的基于 Edwards-Curve Digital Signature Algorithm （EdDSA）实现的数字签名算法。
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 虽然其性能优于现有的 ECDSA 实现，不过，它并不会完全取代 JDK 中现有的椭圆曲线数字签名算法( ECDSA)。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>KeyPairGenerator kpg <span style=color:#f92672>=</span> KeyPairGenerator<span style=color:#f92672>.</span><span style=color:#a6e22e>getInstance</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Ed25519&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>KeyPair kp <span style=color:#f92672>=</span> kpg<span style=color:#f92672>.</span><span style=color:#a6e22e>generateKeyPair</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;test_string&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>getBytes</span><span style=color:#f92672>(</span>StandardCharsets<span style=color:#f92672>.</span><span style=color:#a6e22e>UTF_8</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Signature sig <span style=color:#f92672>=</span> Signature<span style=color:#f92672>.</span><span style=color:#a6e22e>getInstance</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Ed25519&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>sig<span style=color:#f92672>.</span><span style=color:#a6e22e>initSign</span><span style=color:#f92672>(</span>kp<span style=color:#f92672>.</span><span style=color:#a6e22e>getPrivate</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>sig<span style=color:#f92672>.</span><span style=color:#a6e22e>update</span><span style=color:#f92672>(</span>msg<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> s <span style=color:#f92672>=</span> sig<span style=color:#f92672>.</span><span style=color:#a6e22e>sign</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String encodedString <span style=color:#f92672>=</span> Base64<span style=color:#f92672>.</span><span style=color:#a6e22e>getEncoder</span><span style=color:#f92672>().</span><span style=color:#a6e22e>encodeToString</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>encodedString<span style=color:#f92672>);</span>
</span></span></code></pre></div><h3 id=文本块>文本块
<a class=anchor href=#%e6%96%87%e6%9c%ac%e5%9d%97>#</a></h3><p>解决 Java 定义多行字符串时只能通过换行转义或者换行连接符来变通支持的问题，引入三重双引号来定义多行文本。
Java 13 支持两个 <code>"""</code> 符号中间的任何内容都会被解释为字符串的一部分，包括换行符。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>String json <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    &#34;</span>name<span style=color:#e6db74>&#34;:&#34;</span>mkyong<span style=color:#e6db74>&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    &#34;</span>age<span style=color:#e6db74>&#34;:38
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                &#34;&#34;&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               SELECT `EMP_ID`, `LAST_NAME` FROM `EMPLOYEE_TB`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               WHERE `CITY` = &#39;INDIANAPOLIS&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               ORDER BY `EMP_ID`, `LAST_NAME`;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               &#34;&#34;&#34;</span><span style=color:#f92672>;</span>
</span></span></code></pre></div><p>另外， <code>String</code> 类新增加了 3 个新的方法来操作文本块：</p><ul><li><code>formatted(Object... args)</code> ：它类似于 <code>String</code> 的 <code>format()</code> 方法。添加它是为了支持文本块的格式设置。</li><li><code>stripIndent()</code> ：用于去除文本块中每一行开头和结尾的空格。</li><li><code>translateEscapes()</code> ：转义序列如 “\t” 转换为 “\t”</li></ul><p>Java 14 中，为其引入了两个新的转义字符：</p><ul><li><code>\</code> : 表示行尾，不引入换行符</li><li><code>\s</code> ：表示单个空格</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>String str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;凡心所向，素履所往，生如逆旅，一苇以航。&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String str2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        凡心所向，素履所往， \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        生如逆旅，一苇以航。&#34;&#34;&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>str2<span style=color:#f92672>);</span><span style=color:#75715e>// 凡心所向，素履所往， 生如逆旅，一苇以航。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>String text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        java
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        c++\sphp
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;&#34;&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>text<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 输出：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>java
</span></span><span style=display:flex><span>c<span style=color:#f92672>++</span> php
</span></span></code></pre></div><h2 id=java-16>Java 16
<a class=anchor href=#java-16>#</a></h2><h3 id=记录类型>记录类型
<a class=anchor href=#%e8%ae%b0%e5%bd%95%e7%b1%bb%e5%9e%8b>#</a></h3><p>Java 14 引入 <code>record</code> 关键字， <code>record</code> 提供一种紧凑的语法来定义类中的不可变数据。</p><p><code>record</code> 关键字可以简化数据类（一个 Java 类一旦实例化就不能再修改）的定义方式，使用 <code>record</code> 代替 <code>class</code> 定义的类，只需要声明属性，就可以在获得属性的访问方法，以及 <code>toString()</code> ， <code>hashCode()</code>， <code>equals()</code> 方法。</p><p>类似于使用 <code>class</code> 定义类，同时使用了 lombok 插件，并打上了 <code>@Getter</code> , <code>@ToString</code> ， <code>@EqualsAndHashCode</code> 注解</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 这个类具有两个特征
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 1. 所有成员属性都是final
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 2. 全部方法由构造方法，和两个成员属性访问器组成（共三个）
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 那么这种类就很适合使用record来声明
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Rectangle</span> <span style=color:#66d9ef>implements</span> Shape <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>double</span> length<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>double</span> width<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Rectangle</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> length<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> width<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>=</span> length<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> width<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>length</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> length<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>return</span> width<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 1. 使用record声明的类会自动拥有上面类中的三个方法
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 2. 在这基础上还附赠了equals()，hashCode()方法以及toString()方法
</span></span></span><span style=display:flex><span><span style=color:#75715e> * 3. toString方法中包括所有成员属性的字符串表示形式及其名称
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span>record <span style=color:#a6e22e>Rectangle</span><span style=color:#f92672>(</span><span style=color:#66d9ef>float</span> length<span style=color:#f92672>,</span> <span style=color:#66d9ef>float</span> width<span style=color:#f92672>)</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Java 15 支持在局部方法和接口中使用 <code>record</code> 。</p><p>Java 16 中非静态内部类可以定义非常量的静态成员。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Outer</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Inner</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> age<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=instanceof-模式匹配>instanceof 模式匹配
<a class=anchor href=#instanceof-%e6%a8%a1%e5%bc%8f%e5%8c%b9%e9%85%8d>#</a></h3><p>Java 12 首次引入 instanceof 模式匹配。</p><p>Java 13, 14, 15 相比较上个版本无变化，继续收集更多反馈。</p><p>Java 16 模式变量不再隐式为 final。</p><p>新版的 instanceof 可以在判断是否属于具体的类型同时完成转换。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Object obj <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;我是字符串&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>obj <span style=color:#66d9ef>instanceof</span> String str<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>str<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 从 Java SE 16 开始，你可以对 instanceof 中的变量值进行修改。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>learn</span><span style=color:#f92672>(</span>Object obj<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>obj <span style=color:#66d9ef>instanceof</span> String s<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;JavaGuide&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=java-17>Java 17
<a class=anchor href=#java-17>#</a></h2><h3 id=密封类>密封类
<a class=anchor href=#%e5%af%86%e5%b0%81%e7%b1%bb>#</a></h3><p>密封类可以对继承或者实现它们的类进行限制。</p><p>比如抽象类 <code>Person</code> 只允许 <code>Employee</code> 和 <code>Manager</code> 继承。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> sealed <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span>
</span></span><span style=display:flex><span>    permits Employee<span style=color:#f92672>,</span> Manager <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>另外，任何扩展密封类的类本身都必须声明为 <code>sealed</code> 、 <code>non-sealed</code> 或 <code>final</code> 。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Employee</span> <span style=color:#66d9ef>extends</span> Person <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> non<span style=color:#f92672>-</span>sealed <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Manager</span> <span style=color:#66d9ef>extends</span> Person <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>如果允许扩展的子类和封闭类在同一个源代码文件里，封闭类可以不使用 permits 语句，Java 编译器将检索源文件，在编译期为封闭类添加上许可的子类。</p><p>在 JDK 15 引入的 sealed class（密封类）在 JDK 16 得到了改进：更加严格的引用检查和密封类的继承关系。</p><h3 id=streamtolist>Stream.toList()
<a class=anchor href=#streamtolist>#</a></h3><p>如果需要将 <code>Stream</code> 转换成 <code>List</code> ,需要通过调用 <code>collect</code> 方法使用 <code>Collectors.toList()</code> ，代码非常冗长。</p><p>在Java 17中将会变得简单，可以直接调用 <code>toList()</code> 。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>streamToList</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Stream<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> stringStream <span style=color:#f92672>=</span> Stream<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;a&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;b&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;c&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> stringList <span style=color:#f92672>=</span>  stringStream<span style=color:#f92672>.</span><span style=color:#a6e22e>toList</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>String s <span style=color:#f92672>:</span> stringList<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/alex-shpak/hugo-book/edit/main/exampleSite/content/docs/Resource/Java8-17%e8%af%ad%e6%b3%95%e6%96%b0%e7%89%b9%e6%80%a7%e6%80%bb%e7%bb%93.md target=_blank rel=noopener><img src=/Java-HomeWork/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script><script>MathJax={tex:{inlineMath:[["$","$"]]},displayMath:[["$$","$$"],["[[","]]"]],svg:{fontCache:"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#java8-17语法新特性总结>Java8-17语法新特性总结</a><ul><li><a href=#java-8>Java 8</a><ul><li><a href=#interface>Interface</a></li><li><a href=#lambda-表达式>Lambda 表达式</a></li><li><a href=#方法的引用>方法的引用</a></li><li><a href=#optional>Optional</a><ul><li><a href=#如何创建一个-optional>如何创建一个 Optional</a></li><li><a href=#map相关方法>map()相关方法</a></li><li><a href=#判断-value-是否为-null>判断 value 是否为 null</a></li><li><a href=#获取-value>获取 value</a></li><li><a href=#过滤值>过滤值</a></li></ul></li><li><a href=#date-time-api>Date-Time API</a><ul><li><a href=#javatime-主要类>java.time 主要类</a></li><li><a href=#格式化>格式化</a></li><li><a href=#字符串转日期格式>字符串转日期格式</a></li><li><a href=#日期计算>日期计算</a></li><li><a href=#获取指定日期>获取指定日期</a></li><li><a href=#时区>时区</a></li></ul></li></ul></li><li><a href=#java-9>Java 9</a><ul><li><a href=#jshell>JShell</a></li><li><a href=#模块化系统>模块化系统</a></li><li><a href=#快速创建不可变集合>快速创建<em>不可变集合</em></a></li><li><a href=#接口私有方法>接口私有方法</a></li><li><a href=#try-with-resources-增强>try-with-resources 增强</a></li><li><a href=#stream--optional-增强>Stream & Optional 增强</a></li><li><a href=#进程-api>进程 API</a></li></ul></li><li><a href=#java-10>Java 10</a><ul><li><a href=#局部变量类型推断var>局部变量类型推断(var)</a></li><li><a href=#集合增强>集合增强</a></li><li><a href=#optional-增强>Optional 增强</a></li></ul></li><li><a href=#java-11>Java 11</a><ul><li><a href=#http-client-标准化>HTTP Client 标准化</a></li><li><a href=#string-增强>String 增强</a></li><li><a href=#optional-增强-1>Optional 增强</a></li><li><a href=#lambda-参数的局部变量语法>Lambda 参数的局部变量语法</a></li></ul></li><li><a href=#java-12>Java 12</a><ul><li><a href=#string-增强-1>String 增强</a></li><li><a href=#files-增强文件比较>Files 增强（文件比较）</a></li><li><a href=#数字格式化工具类>数字格式化工具类</a></li></ul></li><li><a href=#java-13>Java 13</a><ul><li><a href=#socketapi-重构>SocketAPI 重构</a></li><li><a href=#filesystems>FileSystems</a></li></ul></li><li><a href=#java-14>Java 14</a><ul><li><a href=#空指针异常精准提示>空指针异常精准提示</a></li><li><a href=#switch-的增强>switch 的增强</a></li></ul></li><li><a href=#java-15>Java 15</a><ul><li><a href=#charsequence>CharSequence</a></li><li><a href=#treemap>TreeMap</a></li><li><a href=#eddsa数字签名算法>EdDSA(数字签名算法)</a></li><li><a href=#文本块>文本块</a></li></ul></li><li><a href=#java-16>Java 16</a><ul><li><a href=#记录类型>记录类型</a></li><li><a href=#instanceof-模式匹配>instanceof 模式匹配</a></li></ul></li><li><a href=#java-17>Java 17</a><ul><li><a href=#密封类>密封类</a></li><li><a href=#streamtolist>Stream.toList()</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>